<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Vue.js</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <style>
        body {
            font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif
        }

        table {
            border: 1px solid #b0a07e;
            border-radius: 0.2rem;
            width: 100%;
        }

        thead {
            background-color: #b0a07e;
            color: #f2efe9;
        }

        th,
        td {
            padding: 10px 20px;
        }

        input,
        textarea,
        button {
            margin-bottom: 10px;
            border: 1px solid #b0a07e;
        }

        button {
            background-color: #cdc2ad;
        }

        header {
            display: flex;
            flex-direction: column;
        }

        form {
            display: flex;
            flex-direction: column;
            border: 1px solid #b0a07e;
            border-radius: 0.7rem;
            padding: 20px;
            margin-top: 10px;
        }

        .container {
            display: grid;
            grid-template-columns: auto 640px auto;
        }
    </style>
</head>

<body>
    <div id="app" class="container">
        <aside></aside>
        <main>
            <header>
                <input type="text" placeholder="Search" v-model="search">
            </header>
            <table>
                <thead>
                    <tr>
                        <th style="width: 85%;">Posts</th>
                        <th style="width: 15%;" align="right"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for='(item, index) in filteredItems' :key='index'>
                        <td colspan="2">
                            <div>
                                <div>
                                    <h5>{{item.title}}</h5>
                                    <p>{{item.body}}</p>
                                </div>
                                <div>
                                    <button type="button" @click="editItem(item)">Edit</button>
                                    <button type="button" @click="deleteItem(item)">Delete</button>
                                </div>
                            </div>

                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="2" align="right">{{ this.filteredItems.length }}
                            post{{ this.filteredItems.length > 1 ? 's' : '' }}</td>
                    </tr>
                </tfoot>
            </table>
            <form @submit.prevent="submit">
                <input type="hidden" v-model="id">
                <input type="text" placeholder="Title" v-model="title">
                <textarea name="" id="" cols="30" rows="10" v-model="body"></textarea>
                <button type="submit">Submit</button>
                <button type="reset" @click="clear">Reset</button>
            </form>
        </main>
        <aside></aside>
    </div>

    <script>
        // app Vue instance
        var app = new Vue({
            el: '#app',
            data: {
                id: '',
                title: '',
                body: '',
                search: '',
                items: [
                    { id: 1, title: 'What is Lorem Ipsum?', body: 'Lorem Ipsum is simply dummy text of the printing and typesetting industry.' },
                    { id: 2, title: 'Where does it come from?', body: 'It has roots in a piece of classical Latin literature from 45 BC, making it over 2000 years old.' },
                    { id: 3, title: 'Why do we use it?', body: "The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters, as opposed to using 'Content here, content here', making it look like readable English." },
                    { id: 4, title: 'Where can I get some?', body: 'All the Lorem Ipsum generators on the Internet tend to repeat predefined chunks as necessary, making this the first true generator on the Internet.' },
                    { id: 5, title: 'The standard Lorem Ipsum passage, used since the 1500s', body: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.' }
                ]
            },

            mounted() {
                // console.log('mounted');
            },

            computed: {
                filteredItems() {
                    var searchFilter = this.search && this.search.toLowerCase();
                    var filteredList = this.items;

                    if (searchFilter) {
                        filteredList = filteredList.filter(item => item.title.toLowerCase().indexOf(searchFilter) > -1);
                    }

                    return filteredList;
                }
            },

            methods: {
                deleteItem(item) {
                    const index = this.items.indexOf(item);
                    this.items.splice(index, 1);
                    // console.log('deleteItem: ', item.description);
                },

                submit(event) {
                    if (this.id) {
                        const editedItem = this.items.find(item => item.id === this.id); // arrow function
                        const index = this.items.indexOf(editedItem);
                        Object.assign(this.items[index], {
                            title: this.title,
                            body: this.body
                        });

                    } else {
                        this.items.push({
                            id: (new Date()).getTime(),
                            title: this.title,
                            body: this.body
                        });
                    }

                    // not really working
                    event.target.reset();
                    this.clear();
                },

                editItem(item) {
                    this.id = item.id;
                    this.title = item.title;
                    this.body = item.body;
                },

                clear() {
                    this.id = '';
                    this.title = '';
                    this.body = '';
                }
            }
        });
    </script>
</body>

</html>